"use strict";var aps=require("./aps-handler"),apsPropertyData=require("./aps-property-list"),apsContribution=require("./aps-handler-contribution"),User=require("./controllers/user"),WebPush=require("./controllers/webPush"),Joi=require("joi"),path=require("path");module.exports=[{method:"GET",path:"/api/preview/{path*}",config:{handler:{directory:{path:__dirname+"/preview/"}},auth:!1}},{method:"GET",path:"/api/components",config:{validate:{query:{version:Joi.string().required(),contribution:Joi.boolean().optional()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getComponents},{method:"GET",path:"/api/properties",config:{validate:{query:{version:Joi.string().required(),platform:Joi.string().optional()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getProperties},{method:"GET",path:"/api/componentSchema/{componentId}",config:{validate:{query:{version:Joi.string().required(),schemaVersion:Joi.string().optional()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getComponent},{method:"PUT",path:"/api/componentSchema",config:{validate:{payload:{version:Joi.string().required(),changeMsg:Joi.string().required(),schemaId:Joi.string().required(),sections:Joi.array().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.updateComponentOnDev},{method:"GET",path:"/api/properties/{propertyName}",config:{validate:{query:{version:Joi.string().required(),platform:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getPropertyDetails},{method:"PUT",path:"/api/property",config:{validate:{payload:{name:Joi.string().required(),version:Joi.string().required(),category:Joi.string().optional().allow(""),defaultVal:Joi.alternatives().try(Joi.string(),Joi.number(),Joi.boolean()).optional().allow(""),description:Joi.string().required(),csDescription:Joi.string().optional().allow(""),members:Joi.array().required(),section:Joi.string().optional().allow(""),title:Joi.string().required(),csTitle:Joi.string().optional().allow(""),type:Joi.string().required(),structuralType:Joi.object().optional(),value:Joi.string().optional().allow(""),componentSchemaId:Joi.string().required(),configuration:Joi.object().required(),changeMsg:Joi.string().required(),platform:Joi.string().required(),componentname:Joi.string().optional()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.updatePropertyDetailsOnDev},{method:"PUT",path:"/api/properties",config:{validate:{payload:{version:Joi.string().required(),properties:Joi.array().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.updateProperties},{method:"PUT",path:"/api/declineProperties",config:{validate:{payload:{version:Joi.string().required(),properties:Joi.array().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.declinePropertyChanges},{method:"POST",path:"/api/property",config:{validate:{payload:{version:Joi.string().required(),name:Joi.string().required(),platform:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.addProperty},{method:"POST",path:"/api/user",handler:User.createUser,config:{validate:{payload:{_id:Joi.string().required(),password:Joi.string().required(),username:Joi.string().required(),isAdmin:Joi.boolean().required()}}}},{method:"DELETE",path:"/api/user/{_id}",config:{auth:{strategy:"token",scope:["ADMIN"]}},handler:User.deleteUser},{method:"PUT",path:"/api/user/{_id}",handler:User.updateUser,config:{validate:{payload:{_id:Joi.any().forbidden(),password:Joi.string().optional(),username:Joi.string().optional(),isAdmin:Joi.boolean().optional()}},auth:{strategy:"token",scope:["ADMIN"]}}},{method:"PUT",path:"/api/updatePassword",handler:User.updatePassword,config:{validate:{payload:{_id:Joi.any().forbidden(),password:Joi.string().required(),username:Joi.any().forbidden(),isAdmin:Joi.any().forbidden()}},auth:{strategy:"token",scope:["USER","ADMIN"]}}},{method:"POST",path:"/api/login",handler:User.login,config:{validate:{payload:{_id:Joi.string().required(),password:Joi.string().required()}}}},{method:"GET",path:"/api/changedComponents",config:{validate:{query:{version:Joi.string().required(),contribution:Joi.boolean().optional()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getChangedComponents},{method:"GET",path:"/api/changedProperties",config:{validate:{query:{version:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getChangedProperties},{method:"GET",path:"/api/getSchemaChanges",config:{validate:{query:{version:Joi.string().required(),component:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.getSchemaChanges},{method:"PUT",path:"/api/approveChanges",config:{validate:{payload:{version:Joi.string().required(),component:Joi.object().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.approveSchemaChanges},{method:"PUT",path:"/api/declineChanges",config:{validate:{payload:{version:Joi.string().required(),component:Joi.object().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.declineSchemaChanges},{method:"GET",path:"/api/previewChanges",config:{validate:{query:{version:Joi.string().required(),component:Joi.string().required(),type:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.previewChanges},{method:"POST",path:"/api/previewChanges",config:{validate:{payload:{version:Joi.string().required(),schema:Joi.any().required(),component:Joi.any().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:aps.previewChanges},{method:"GET",path:"/api/versions",handler:aps.getVersions},{method:"POST",path:"/api/versionStash",config:{validate:{payload:{version:Joi.string().required(),branchName:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.createVersionStash},{method:"POST",path:"/api/generatePR",config:{validate:{payload:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.generatePR},{method:"POST",path:"/api/analyzeSchema",config:{validate:{payload:{version:Joi.string().required(),schema:Joi.alternatives().try(Joi.array(),Joi.object())}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.analyzeSchema},{method:"POST",path:"/api/createComponent",config:{validate:{payload:{version:Joi.string().required(),schema:Joi.alternatives().try(Joi.array(),Joi.object()),settingsTsFile:Joi.string().optional(),componentName:Joi.string().required(),platform:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.createComponent},{method:"GET",path:"/api/pendingApproval",config:{validate:{query:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.getPendingApproval},{method:"GET",path:"/api/pendingPR",config:{validate:{query:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.getPendingPR},{method:"POST",path:"/api/generateAll",config:{validate:{payload:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:aps.generateAll},{method:"GET",path:"/api/componentProperties/{componentId}",config:{validate:{query:{version:Joi.string().required(),platform:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:apsContribution.getcomponentProperties},{method:"PUT",path:"/api/propertySchema",config:{validate:{payload:{version:Joi.string().required(),componentId:Joi.string().required(),properties:Joi.any().required(),changeMsg:Joi.string().optional().allow("")}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:apsContribution.updateContributionProperties},{method:"GET",path:"/api/getComponentText",config:{validate:{query:{version:Joi.string().required(),schemaId:Joi.string().required()}},auth:{strategy:"token",scope:["USER","ADMIN"]}},handler:apsContribution.getComponentText},{method:"PUT",path:"/api/approveChangesCB",config:{validate:{payload:{version:Joi.string().required(),component:Joi.object().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:apsContribution.approveSchemaChangesCB},{method:"PUT",path:"/api/declineChangesCB",config:{validate:{payload:{version:Joi.string().required(),component:Joi.object().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:apsContribution.declineSchemaChangesCB},{method:"POST",path:"/api/generateTextFiles",config:{validate:{payload:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:apsContribution.generateTextFiles},{method:"POST",path:"/api/generatePullRequestCB",config:{validate:{payload:{version:Joi.string().required()}},auth:{strategy:"token",scope:["ADMIN"]}},handler:apsContribution.generatePullRequestCB},{method:"POST",path:"/api/subscribe",handler:WebPush.createSubscription},{method:"POST",path:"/api/unsubscribe",handler:WebPush.deleteSubscription},{method:"POST",path:"/api/notifyAll",handler:WebPush.notifyAll},{method:"GET",path:"/api/repairCS",handler:aps.getCSData},{method:"POST",path:"/api/repairCS",handler:aps.repairCS},{method:"POST",path:"/api/repairCompSchema",handler:aps.repairCompSchema},{method:"GET",path:"/api/getPropertyData",handler:apsPropertyData.getPropertyData},{method:"GET",path:"/{path*}",config:{handler:{directory:{path:path.join(__dirname,"../client/")}},auth:!1}}];