"use strict";var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var webPush=require("../lib/webPush");exports.createSubscription=function(e){var t=e.db;return new _promise2.default(function(i,n){t.collection("subscription").insertOne(e.data,function(e,t){return e?n(e):i(t)})})},exports.deleteSubscription=function(e){var t=e.db;return new _promise2.default(function(i,n){t.collection("subscription").deleteOne(e.data,function(e,t){return e?n(e):i(t)})})},exports.notifyAll=function(n){var i=n.db;return new _promise2.default(function(e,t){i.collection("subscription").find().each(function(e,t){if(t){var i={endpoint:t._id,keys:{p256dh:t.publicKey,auth:t.auth}};webPush.sendPushNotification(i,n.data)}})})};