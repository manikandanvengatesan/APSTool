"use strict";var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var webPush=require("../lib/webPush");exports.createSubscription=function(e){var t=e.db;return new _promise2.default(function(i,n){t.collection("subscription").insertOne(e.data,function(e,t){return e?n(e):i(t)})})},exports.deleteSubscription=function(e){var t=e.db;return new _promise2.default(function(i,n){t.collection("subscription").deleteOne(e.data,function(e,t){return e?n(e):i(t)})})},exports.notifyAll=function(e){var t=e.db;return new _promise2.default(function(i,n){t.collection("subscription").find().each(function(t,i){if(i){var n={endpoint:i._id,keys:{p256dh:i.publicKey,auth:i.auth}};webPush.sendPushNotification(n,e.data)}})})};